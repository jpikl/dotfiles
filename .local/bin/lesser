#!/usr/bin/env sh
# shellcheck disable=SC2064

set -eu

TEMP=$(mktemp)
trap "rm -f -- '$TEMP'" EXIT

MAX=$(tput lines)
COUNT=0

while read -r LINE; do
    echo "$LINE" >>"$TEMP"
    COUNT=$((COUNT + 1))

    # Run real pager only when output is bigger than terminal height
    if [ $COUNT -gt "$MAX" ]; then
       cat "$TEMP" - | less "$@"
       exit
    fi
done

cat "$TEMP"
