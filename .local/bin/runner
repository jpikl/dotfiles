#!/usr/bin/env sh

set -eu

if [ $# -eq 0 ]; then
    echo >&2 "Usage: ${0##*/} <scripts-dir>"
    exit 1
fi

cd "$1"

script_id() {
    echo "${1%%-*}"
}

script_label() {
    echo "$1" | sed -E 's/^[^-]+-//;s/.sh$//;s/-/ /g'
}

list_scripts() {
    for SCRIPT in *.sh; do
        echo "$(script_id "$SCRIPT")) $(script_label "$SCRIPT")"
    done
    echo
}

run_script() {
    for SCRIPT in *.sh; do
        if [ "$(script_id "$SCRIPT")" = "$1" ]; then
            echo
            echo "====================[ $(script_label "$SCRIPT") :: start ]===================="
            echo
            "./$SCRIPT"
            echo
            echo "====================[ $(script_label "$SCRIPT") :: end ]===================="
            echo
            return 0
        fi
    done
    return 1
}

while true; do
    list_scripts

    while true; do
        printf "Script to run: "
        read -r ANSWER
        run_script "$ANSWER" && break
    done
done
